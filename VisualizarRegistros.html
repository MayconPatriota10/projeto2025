<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registros de Ponto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="VisualizarRegistros.css">
</head>
<body>
    <div class="container">
        <h3>Registros de Ponto</h3>
        <div class="form-group mb-3">
            <label for="turma">Filtrar por Turma:</label>
            <select class="form-control" id="turma" onchange="updateTable()">
                <option value="" selected>Todas as turmas</option>
                <option value="1anoA">1º Ano A</option>
                <option value="1anoB">1º Ano B</option>
                <option value="2anoA">2º Ano A</option>
                <option value="2anoB">2º Ano B</option>
                <option value="3anoA">3º Ano A</option>
                <option value="3anoB">3º Ano B</option>
            </select>
        </div>
        <div class="form-group mb-3">
            <label for="search">Pesquisar por Nome ou CPF:</label>
            <input type="text" class="form-control" id="search" placeholder="Digite o nome ou CPF" oninput="updateTable()">
        </div>
        <div class="alert alert-info mb-3" id="totalEntradas">
            Total de alunos que registraram entrada hoje: <span id="count">0</span>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>CPF</th>
                        <th>Ação</th>
                        <th>Data</th>
                        <th>Horário</th>
                    </tr>
                </thead>
                <tbody id="registrosTable">
                    <!-- Registros serão preenchidos dinamicamente -->
                </tbody>
            </table>
        </div>
        <a href="index.html" class="btn btn-secondary w-100 mt-3">Voltar</a>
    </div>
    <script>
        // Sample data for demonstration
        const sampleData = [
            { nome: "João Silva", cpf: "123.456.789-00", turma: "1anoA", acao: "Entrada", data: "2025-07-26", horario: "08:00" },
            { nome: "Maria Souza", cpf: "987.654.321-00", turma: "1anoB", acao: "Saída", data: "2025-07-26", horario: "14:00" },
            { nome: "Pedro Santos", cpf: "111.222.333-44", turma: "2anoA", acao: "Entrada", data: "2025-07-26", horario: "09:00" },
            { nome: "Ana Lima", cpf: "555.666.777-88", turma: "1anoA", acao: "Entrada", data: "2025-07-26", horario: "08:30" },
            { nome: "Lucas Pereira", cpf: "444.555.666-77", turma: "3anoB", acao: "Entrada", data: "2025-07-25", horario: "07:45" }
        ];

        function updateTable() {
            const selectedClass = document.getElementById("turma").value;
            const searchQuery = document.getElementById("search").value.toLowerCase();
            const tbody = document.getElementById("registrosTable");
            const today = new Date().toISOString().split("T")[0]; // Current date in YYYY-MM-DD
            tbody.innerHTML = "";

            const filteredData = sampleData.filter(record => {
                const matchesClass = selectedClass === "" || record.turma === selectedClass;
                const matchesDate = record.data === today;
                const matchesSearch = record.nome.toLowerCase().includes(searchQuery) || 
                                     record.cpf.toLowerCase().includes(searchQuery);
                return matchesClass && matchesDate && matchesSearch;
            });

            filteredData.forEach(record => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${record.nome}</td>
                    <td>${record.cpf}</td>
                    <td>${record.acao}</td>
                    <td>${record.data}</td>
                    <td>${record.horario}</td>
                `;
                tbody.appendChild(row);
            });

            updateTotalEntradas();
        }

        function updateTotalEntradas() {
            const selectedClass = document.getElementById("turma").value;
            const today = new Date().toISOString().split("T")[0];
            const count = sampleData.filter(record => 
                record.acao === "Entrada" && 
                record.data === today && 
                (selectedClass === "" || record.turma === selectedClass)
            ).length;
            document.getElementById("count").textContent = count;
        }

        window.onload = updateTable;
    </script>
</body>
</html>